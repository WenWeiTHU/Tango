{"version":3,"sources":["Menu.js"],"names":["cc","Class","extends","Component","properties","player1","type","Node","default","player2","startBtn","Button","helpBtn","bindR","bindL","enemyStatic","enemySpin","BlastPrefab1","Prefab","BlastPrefab2","enemySwing1","enemySwing2","bgm","AudioClip","onLoad","audioEngine","isMusicPlaying","playMusic","setBtn","setLocalStorage","initUI","sys","localStorage","length","setItem","i","String","JSON","stringify","spinDegree","bindAnimComponent","getComponent","Animation","bindAnimState","play","wrapMode","WrapMode","Loop","bindAnimComponent2","bindAnimState2","swingRight","moveBy","v2","x","easing","easeCubicActionInOut","rotate1","rotateBy","rotate2","swingLeft","runAction","repeatForever","sequence","schedule","explosion","node","on","sceneName","director","_loadingScene","loadScene","startClick","getScene","name","blast","instantiate","addChild","setPosition","y","animComponent","blast2","animComponent2","start","updateRotatation","newDegree","rotation","Math","PI","sin","cos","update","dt"],"mappings":"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","file":"Menu.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\StartMenu","sourcesContent":["/*\n * 开始菜单脚本\n */\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        player1: {\n            type: cc.Node,\n            default: null\n        },\n        player2: {\n            type: cc.Node,\n            default: null\n        },\n        startBtn: {\n            type: cc.Button,\n            default: null\n        },\n        helpBtn: {\n            type: cc.Button,\n            default: null\n        },\n        bindR: {\n            type: cc.Node,\n            default: null\n        },\n        bindL: {\n            type: cc.Node,\n            default: null\n        },\n        enemyStatic: {\n            type: cc.Node,\n            default: null\n        },\n        enemySpin: {\n            type: cc.Node,\n            default: null\n        },\n        BlastPrefab1: {\n            type: cc.Prefab,\n            default: null,\n        },\n        BlastPrefab2: {\n            type: cc.Prefab,\n            default: null,\n        },\n        enemySwing1: {\n            type: cc.Node,\n            default: null,\n        },\n        enemySwing2: {\n            type: cc.Node,\n            default: null,\n        },\n        bgm:{\n            type: cc.AudioClip,\n            default: null,\n        }\n    },\n\n    /*\n     * 初始化函数\n     * 功能：初始化脚本所需设定\n     */\n    onLoad() {\n        if(!cc.audioEngine.isMusicPlaying()){\n            cc.audioEngine.playMusic(this.bgm, true)\n        }\n        this.setBtn()\n        this.setLocalStorage()\n        this.initUI()\n    },\n\n    /*\n     * 检查本地储存函数\n     * 功能：检查本地储存，并设定本地储存\n     */\n    setLocalStorage () {\n        if( cc.sys.localStorage.length <= 1) {\n            cc.sys.localStorage.setItem(\"Stage1\", true)\n            for(var i = 2; i < 13; ++i) {\n                cc.sys.localStorage.setItem(\"Stage\" + String(i), false)\n            }\n            cc.sys.localStorage.setItem('highestScore', -1)\n            cc.sys.localStorage.setItem('ranking', JSON.stringify([]))\n        }\n    },\n\n    /*\n     * 初始化UI函数\n     * 功能：初始化开始界面中的动画UI\n     */\n    initUI () {\n        this.spinDegree = 0\n\n        var bindAnimComponent = this.bindR.getComponent(cc.Animation)\n        var bindAnimState = bindAnimComponent.play('bindAnim2')\n        bindAnimState.wrapMode = cc.WrapMode.Loop\n\n        var bindAnimComponent2 = this.bindL.getComponent(cc.Animation)\n        var bindAnimState2 = bindAnimComponent2.play('bindAnim2')\n        bindAnimState2.wrapMode = cc.WrapMode.Loop\n\n        var swingRight = cc.moveBy(2.0, cc.v2(this.enemySwing2.x - this.enemySwing1.x, 0)).easing(cc.easeCubicActionInOut())\n        var rotate1 = cc.rotateBy(1.0 , 180)\n        var rotate2 = cc.rotateBy(1.0 , -180)\n        var swingLeft = cc.moveBy(2.0, cc.v2(this.enemySwing1.x - this.enemySwing2.x, 0)).easing(cc.easeCubicActionInOut())\n        // 不断重复\n        this.enemySwing1.runAction(cc.repeatForever(cc.sequence(swingRight, rotate1, swingLeft, rotate2)))\n        this.enemySwing2.runAction(cc.repeatForever(cc.sequence(swingLeft, rotate2, swingRight, rotate1)))\n\n        this.schedule(this.explosion, 3);\n    },\n\n    /*\n     * 初始化按键函数\n     * 功能：初始化按钮的回调函数\n     */\n    setBtn () {\n        this.startBtn.node.on('click', function(){\n            var sceneName = cc.director._loadingScene\n            if (sceneName != 'Selection') {\n                cc.director.loadScene('Selection')\n            }\n        }, this)\n        this.helpBtn.node.on('click', function(){\n            var sceneName = cc.director._loadingScene\n            if (sceneName != 'Help') {\n                cc.director.loadScene('Help')\n            }\n        }, this)\n    },\n\n    /*\n     * 开始函数\n     * 功能：当开始按键被按下时，加载下一个场景\n     */\n    startClick() {\n        var sceneName = cc.director.getScene().name\n        if (sceneName != 'Selection') {\n            cc.director.loadScene('Selection')\n        }\n    },\n\n    /*\n     * 爆炸函数\n     * 功能：设置动画中的爆炸效果\n     */\n    explosion () {\n        let blast = cc.instantiate(this.BlastPrefab1)\n        this.node.addChild(blast)\n        blast.setPosition(this.player1.x, this.player1.y)\n        let animComponent = blast.getComponent(cc.Animation)\n        animComponent.play('blast1')\n\n        let blast2 = cc.instantiate(this.BlastPrefab2)\n        this.node.addChild(blast2)\n        blast2.setPosition(this.player2.x, this.player2.y)\n        let animComponent2 = blast2.getComponent(cc.Animation)\n        animComponent2.play('blast2')\n    },\n\n    start() {\n    },\n\n    /*\n     * 更新旋转函数\n     * 功能：使UI动画中的对象发生旋转\n     */\n    updateRotatation () {\n        var newDegree = this.enemyStatic.rotation + (10 / Math.PI);\n        this.enemyStatic.rotation = newDegree > 360 ? newDegree - 360 : newDegree\n        this.enemySpin.rotation = newDegree > 360 ? newDegree - 360 : newDegree;\n\n        this.spinDegree += 0.3\n        this.spinDegree = this.spinDegree > 360 ? this.spinDegree - 360 : this.spinDegree\n        this.enemySpin.x = this.enemyStatic.x + 135 * Math.sin(this.spinDegree * Math.PI / 180)\n        this.enemySpin.y = this.enemyStatic.y + 135 * Math.cos(this.spinDegree * Math.PI / 180)\n    },\n\n    // 系统调用的更新函数\n    update(dt) {\n        this.updateRotatation()\n    },\n});"]}