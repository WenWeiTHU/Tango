{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\Game/assets\\scripts\\Game\\EnemySpin.js"],"names":["cc","Class","extends","require","properties","Player","type","Node","default","override","centerX","centerY","centerSpeed","radius","circulateUpdate","onLoad","director","getCollisionManager","enabled","angle","circulateDir","circulate","node","x","Math","sin","PI","y","cos","start","onCollisionEnter","other","self","group","explode","Explode","play","blast","instantiate","BlastPrefab","parent","addChild","setPosition","animComponent","getComponent","Animation","destroy","updatePos","dt","dir","v2","distance","mag","update","rotate"],"mappings":";;;;;;AAAA;;;;AAIAA,GAAGC,KAAH,CAAS;AACLC,aAASC,QAAQ,YAAR,CADJ;;AAGLC,gBAAY;AACRC,gBAAQ;AACJC,kBAAMN,GAAGO,IADL;AAEJC,qBAAS,IAFL;AAGJC,sBAAU;AAHN,SADA;AAMRC,iBAAS,CAND;AAORC,iBAAS,CAPD;AAQRC,qBAAa,EARL;AASRC,gBAAQ,GATA;AAURC,yBAAiB;AAVT,KAHP;;AAiBL;;;;AAIAC,UArBK,oBAqBK;AACN;AACAf,WAAGgB,QAAH,CAAYC,mBAAZ,GAAkCC,OAAlC,GAA4C,IAA5C;;AAEA,aAAKC,KAAL,GAAa,CAAb;AACA,aAAKC,YAAL,GAAoB,CAApB;AACH,KA3BI;;;AA6BL;;;;AAIAC,aAjCK,uBAiCQ;AACT,aAAKF,KAAL,IAAc,KAAKC,YAAL,GAAkB,KAAKN,eAArC;;AAEA,aAAKK,KAAL,GAAa,KAAKA,KAAL,GAAa,GAAb,GAAmB,KAAKA,KAAL,GAAa,GAAhC,GAAsC,KAAKA,KAAxD;;AAEA,aAAKG,IAAL,CAAUC,CAAV,GAAc,KAAKb,OAAL,GAAe,KAAKG,MAAL,GAAcW,KAAKC,GAAL,CAAS,KAAKN,KAAL,GAAaK,KAAKE,EAAlB,GAAuB,GAAhC,CAA3C;AACA,aAAKJ,IAAL,CAAUK,CAAV,GAAc,KAAKhB,OAAL,GAAe,KAAKE,MAAL,GAAcW,KAAKI,GAAL,CAAS,KAAKT,KAAL,GAAaK,KAAKE,EAAlB,GAAuB,GAAhC,CAA3C;AACH,KAxCI;AA0CLG,SA1CK,mBA0CG,CACP,CA3CI;;;AA6CL;;;;AAIAC,oBAjDK,4BAiDaC,KAjDb,EAiDoBC,IAjDpB,EAiD0B;AAC3B,YAAID,MAAMT,IAAN,CAAWW,KAAX,IAAoB,KAAxB,EAA+B;AAC3B;AACA,iBAAKb,YAAL,IAAqB,CAAC,CAAtB;AACA;AACH,SAJD,MAKK;AACD;AACA,iBAAKc,OAAL;AACH;AACJ,KA3DI;;;AA6DL;;;;AAIAA,WAjEK,qBAiEM;AACP,aAAKC,OAAL,CAAaC,IAAb;AACA,YAAIC,QAAQrC,GAAGsC,WAAH,CAAe,KAAKC,WAApB,CAAZ;;AAEA,aAAKjB,IAAL,CAAUkB,MAAV,CAAiBC,QAAjB,CAA0BJ,KAA1B;AACAA,cAAMK,WAAN,CAAkB,KAAKpB,IAAL,CAAUC,CAA5B,EAA+B,KAAKD,IAAL,CAAUK,CAAzC;;AAEA,YAAIgB,gBAAgBN,MAAMO,YAAN,CAAmB5C,GAAG6C,SAAtB,CAApB;AACAF,sBAAcP,IAAd,CAAmB,QAAnB;;AAEA,aAAKd,IAAL,CAAUwB,OAAV;AACH,KA5EI;;;AA8EL;;;;AAIAC,aAlFK,qBAkFMC,EAlFN,EAkFU;AACX,aAAKC,GAAL,GAAWjD,GAAGkD,EAAH,CAAM,KAAK7C,MAAL,CAAYkB,CAAZ,GAAgB,KAAKb,OAA3B,EAAoC,KAAKL,MAAL,CAAYsB,CAAZ,GAAgB,KAAKhB,OAAzD,CAAX;AACA,aAAKwC,QAAL,GAAgB,KAAKF,GAAL,CAASG,GAAT,EAAhB;;AAEA,aAAK1C,OAAL,IAAgB,KAAKuC,GAAL,CAAS1B,CAAT,GAAa,KAAK4B,QAAlB,GAA6B,KAAKvC,WAAlC,GAAgDoC,EAAhE;AACA,aAAKrC,OAAL,IAAgB,KAAKsC,GAAL,CAAStB,CAAT,GAAa,KAAKwB,QAAlB,GAA6B,KAAKvC,WAAlC,GAAgDoC,EAAhE;AACH,KAxFI;;;AA0FL;AACAK,UA3FK,kBA2FEL,EA3FF,EA2FM;AACP,aAAKM,MAAL;AACA,aAAKP,SAAL;AACA,aAAK1B,SAAL;AACH;AA/FI,CAAT","file":"EnemySpin.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\Game","sourcesContent":["/*\n * 旋转围绕敌人脚本\n */\n\ncc.Class({\n    extends: require(\"EnemyTrack\"),\n\n    properties: {\n        Player: {\n            type: cc.Node,\n            default: null,\n            override: true\n        },\n        centerX: 0,\n        centerY: 0,\n        centerSpeed: 50,\n        radius: 100,\n        circulateUpdate: 2,\n    },\n\n\n    /*\n     * 初始化函数\n     * 功能：初始化脚本所需的设定\n     */\n    onLoad () {\n        // 开启碰撞检测\n        cc.director.getCollisionManager().enabled = true;\n\n        this.angle = 0\n        this.circulateDir = 1\n    },\n\n    /*\n     * 自转函数\n     * 功能：更新对象自转角度\n     */\n    circulate () {\n        this.angle += this.circulateDir*this.circulateUpdate;\n\n        this.angle = this.angle > 360 ? this.angle - 360 : this.angle\n\n        this.node.x = this.centerX + this.radius * Math.sin(this.angle * Math.PI / 180)\n        this.node.y = this.centerY + this.radius * Math.cos(this.angle * Math.PI / 180)\n    },\n\n    start() {\n    },\n    \n    /*\n     * 碰撞检测函数\n     * 功能：当敌人发生碰撞时，调用此函数对对象进行处理\n     */\n    onCollisionEnter (other, self) {\n        if (other.node.group == \"Map\") {\n            // 如果碰到了地图边界，则直接反弹\n            this.circulateDir *= -1\n            return\n        }\n        else {\n            // 如果碰到了其他对象，则发生爆炸并销毁\n            this.explode()\n        }\n    },\n\n    /*\n     * 爆炸函数\n     * 功能：产生爆炸动画并销毁自身\n     */\n    explode () {\n        this.Explode.play()\n        var blast = cc.instantiate(this.BlastPrefab)\n\n        this.node.parent.addChild(blast)\n        blast.setPosition(this.node.x, this.node.y)\n\n        var animComponent = blast.getComponent(cc.Animation)\n        animComponent.play('blast3')\n\n        this.node.destroy()\n    },\n\n    /*\n     * 更新位置函数\n     * 功能：根据分速度来更新对象的下一个位置\n     */\n    updatePos (dt) {\n        this.dir = cc.v2(this.Player.x - this.centerX, this.Player.y - this.centerY)\n        this.distance = this.dir.mag()\n\n        this.centerX += this.dir.x / this.distance * this.centerSpeed * dt\n        this.centerY += this.dir.y / this.distance * this.centerSpeed * dt\n    },\n\n    // 系统调用的更新函数\n    update(dt) {\n        this.rotate()\n        this.updatePos()\n        this.circulate()\n    },\n});"]}