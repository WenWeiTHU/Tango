{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\Game/assets\\scripts\\Game\\Game.js"],"names":["cc","Class","extends","Component","properties","Player1","type","Node","default","Player2","SupplyPrefab","Prefab","MapVerPrefab","MapHerPrefab","StaticEnemyPrefab","TrackEnemyPrefab","SpinEnemyPrefab","SwingEnemyPrefab","BatteryPrefab","BulletPrefab","staticEnemyNum","supplyTimeGap","getNewPosition","maxX","node","width","randX","Math","random","maxY","height","randY","v2","generateNewStaticEnemy","newEnemy","instantiate","addChild","setPosition","generateNewTrackEnemy","console","log","getComponent","Player","generateNewSpinEnemy","generateNewSwingEnemy","generateSupply","newSupply","Game","generateBattery","newBattery","generateMap","equipmentWidth","equipmentHeight","mapUp","y","x","name","_components","_size","mapDown","mapLeft","mapRight","onLoad","i","children","length","zIndex","sortAllChildren","start","scheduleOnce","initGame","schedule","update","dt"],"mappings":"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","file":"Game.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\Game","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        \r\n        Player1:{\r\n            type: cc.Node,\r\n            default: null,\r\n        },\r\n        Player2:{\r\n            type: cc.Node,\r\n            default: null,\r\n        },\r\n        SupplyPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        MapVerPrefab: {\r\n            type: cc.Prefab,\r\n            default: null\r\n        },\r\n        MapHerPrefab: {\r\n            type: cc.Prefab,\r\n            default: null\r\n        },\r\n        \r\n        StaticEnemyPrefab: {\r\n            type: cc.Prefab,\r\n            default: null\r\n        },\r\n        TrackEnemyPrefab: {\r\n            type: cc.Prefab,\r\n            default: null\r\n        },\r\n        SpinEnemyPrefab: {\r\n            type: cc.Prefab,\r\n            default: null\r\n        },\r\n        SwingEnemyPrefab: {\r\n            type: cc.Prefab,\r\n            default: null\r\n        },\r\n        BatteryPrefab: {\r\n            type: cc.Prefab,\r\n            default: null\r\n        },\r\n        BulletPrefab: {\r\n            type: cc.Prefab,\r\n            default: null\r\n        },\r\n        staticEnemyNum: 0,\r\n        supplyTimeGap: 1,\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    getNewPosition: function () {\r\n        var maxX = this.node.width / 2;\r\n        var randX = (Math.random() - 0.5) * 2 * maxX;\r\n        var maxY = this.node.height / 2;\r\n        var randY = (Math.random() - 0.5) * 2 * maxY;\r\n\r\n        return cc.v2(randX, randY);\r\n    },\r\n\r\n    generateNewStaticEnemy: function () {\r\n        var newEnemy = cc.instantiate(this.StaticEnemyPrefab);\r\n        this.node.addChild(newEnemy);\r\n        newEnemy.setPosition(0, 0);\r\n    },\r\n\r\n    generateNewTrackEnemy: function () {\r\n        console.log('track')\r\n        var newEnemy = cc.instantiate(this.TrackEnemyPrefab);\r\n        this.node.addChild(newEnemy);\r\n\r\n        let random = Math.random()\r\n        if(random < 0.5){\r\n            newEnemy.getComponent('EnemyTrack').Player = this.Player1\r\n        }\r\n        else{\r\n            newEnemy.getComponent('EnemyTrack').Player = this.Player2\r\n        }\r\n        \r\n        newEnemy.setPosition(0, 0);\r\n    },\r\n\r\n    generateNewSpinEnemy: function () {\r\n        console.log('spin')\r\n        var newEnemy = cc.instantiate(this.SpinEnemyPrefab);\r\n        this.node.addChild(newEnemy);\r\n        var random = Math.random()\r\n        if(random < 0.5){\r\n            newEnemy.getComponent('EnemySpin').Player = this.Player1\r\n        }\r\n        else{\r\n            newEnemy.getComponent('EnemySpin').Player = this.Player2\r\n        }\r\n\r\n        newEnemy.setPosition(0, 0);\r\n    },\r\n\r\n    generateNewSwingEnemy: function () {\r\n        var newEnemy = cc.instantiate(this.SwingEnemyPrefab);\r\n        this.node.addChild(newEnemy);\r\n        newEnemy.setPosition(0, 0);\r\n    },\r\n\r\n    generateSupply: function () {\r\n        var newSupply = cc.instantiate(this.SupplyPrefab)\r\n        this.node.addChild(newSupply)\r\n        newSupply.setPosition(this.getNewPosition())\r\n        newSupply.getComponent('Supply').Game = this\r\n    },\r\n\r\n    generateBattery(){\r\n        var newBattery = cc.instantiate(this.BatteryPrefab)\r\n        this.node.addChild(newBattery)\r\n        newBattery.setPosition(this.getNewPosition())\r\n        newBattery.getComponent('Battery').Player1 = this.Player1\r\n        newBattery.getComponent('Battery').Player2 = this.Player2\r\n        newBattery.getComponent('Battery').BulletPrefab = this.BulletPrefab\r\n    },\r\n\r\n    /*\r\n     * 根据设备分辨率生成地图边界\r\n     */\r\n    generateMap () {\r\n        var equipmentWidth = this.node.width\r\n        var equipmentHeight = this.node.height\r\n\r\n        var mapUp = cc.instantiate(this.MapHerPrefab)\r\n        mapUp.y = (equipmentHeight + mapUp.height) / 2\r\n        mapUp.x = 0\r\n        mapUp.width = equipmentWidth + 10;\r\n        mapUp.name = 'mapUp'\r\n        \r\n        mapUp._components[1]._size.width = equipmentWidth + 10;\r\n        \r\n\r\n        var mapDown = cc.instantiate(this.MapHerPrefab)\r\n        mapDown.y = -(equipmentHeight + mapDown.height) / 2\r\n        mapDown.x = 0\r\n        mapDown.name = 'mapDown'\r\n        mapDown.width = equipmentWidth + 10\r\n        mapDown._components[1]._size.width = equipmentWidth + 10\r\n        \r\n\r\n        var mapLeft = cc.instantiate(this.MapVerPrefab)\r\n        mapLeft.x = -(equipmentWidth + mapLeft.width) / 2\r\n        mapLeft.y = 0\r\n        mapLeft.name = 'mapLeft'\r\n        mapLeft.height = equipmentHeight + 10\r\n        mapLeft._components[1]._size.height = equipmentHeight + 10\r\n\r\n        var mapRight = cc.instantiate(this.MapVerPrefab)\r\n        mapRight.x = (equipmentWidth + mapRight.width) / 2\r\n        mapRight.y = 0\r\n        mapRight.name = 'mapRight'\r\n        mapRight.height = equipmentHeight + 10\r\n        mapRight._components[1]._size.height = equipmentHeight + 10\r\n\r\n        this.node.addChild(mapUp)\r\n        this.node.addChild(mapDown)\r\n        this.node.addChild(mapLeft)\r\n        this.node.addChild(mapRight)\r\n    },\r\n\r\n    onLoad() {\r\n        for (var i = 0; i < this.node.children.length; ++i) {\r\n            switch (this.node.children[i].name) {\r\n                case 'player1': {\r\n                    this.node.children[i].zIndex = 100;\r\n                    break;\r\n                }\r\n                case 'player2': {\r\n                    this.node.children[i].zIndex = 100;\r\n                    break;\r\n                }\r\n                case 'stickLeft':\r\n                case 'stickRight': {\r\n                    this.node.children[i].zIndex = 101;\r\n                    break;\r\n                }\r\n                case 'bg': {\r\n                    this.node.children[i].zIndex = -100;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        this.node.sortAllChildren();\r\n    },\r\n\r\n    start() {\r\n       this.scheduleOnce(this.initGame, 2);\r\n       this.generateMap()\r\n    },\r\n\r\n    initGame() {\r\n        this.generateNewStaticEnemy()\r\n        this.generateNewTrackEnemy()\r\n        this.generateNewSpinEnemy()\r\n        this.generateNewSwingEnemy()\r\n        this.generateBattery()\r\n        this.schedule(this.generateSupply, 2)\r\n    },\r\n\r\n    update(dt) {\r\n    },\r\n});"]}